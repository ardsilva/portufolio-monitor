<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>üìä Monitor de Carteira - Gest√£o Manual</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      background: #0a0a0a;
      color: #e0e0e0;
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    h1, h2 { color: #00ffcc; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #444;
      padding: 8px;
      text-align: center;
    }
    th {
      background: #1e1e1e;
    }
    input[type="number"] {
      background: #1a1a1a;
      color: #fff;
      border: 1px solid #444;
      border-radius: 3px;
      text-align: right;
      width: 90px;
    }
    .gain { color: #00ff99; }
    .loss { color: #ff6666; }
    canvas { margin-top: 40px; }
  </style>
</head>
<body>

  <h1>üìà Monitoramento de Carteira (Atual + Futura)</h1>
  <p>Atualize manualmente o pre√ßo atual para ver ganhos/perdas e proje√ß√£o da carteira.</p>

  <h2>1Ô∏è‚É£ Carteira Atual</h2>
  <table id="currentTable">
    <thead>
      <tr>
        <th>Ativo</th>
        <th>Unidades</th>
        <th>Investido (‚Ç¨)</th>
        <th>Pre√ßo Atual (‚Ç¨)</th>
        <th>Valor Atual (‚Ç¨)</th>
        <th>Ganho/Perda (‚Ç¨)</th>
        <th>Ganho/Perda (%)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>VUAA.MIL</td>
        <td>5.59244187</td>
        <td>630.49</td>
        <td><input type="number" step="0.01" placeholder="Pre√ßo atual"></td>
        <td class="valorAtual">‚Äî</td>
        <td class="ganhoValor">‚Äî</td>
        <td class="ganhoPerc">‚Äî</td>
      </tr>
      <tr>
        <td>QSVE.XETR</td>
        <td>16.49031194</td>
        <td>604.53</td>
        <td><input type="number" step="0.01" placeholder="Pre√ßo atual"></td>
        <td class="valorAtual">‚Äî</td>
        <td class="ganhoValor">‚Äî</td>
        <td class="ganhoPerc">‚Äî</td>
      </tr>
      <tr>
        <td>IGLD.XETR</td>
        <td>7.64058679</td>
        <td>557.15</td>
        <td><input type="number" step="0.01" placeholder="Pre√ßo atual"></td>
        <td class="valorAtual">‚Äî</td>
        <td class="ganhoValor">‚Äî</td>
        <td class="ganhoPerc">‚Äî</td>
      </tr>
      <tr>
        <td>MSFT</td>
        <td>1.0208905</td>
        <td>448.00</td>
        <td><input type="number" step="0.01" placeholder="Pre√ßo atual"></td>
        <td class="valorAtual">‚Äî</td>
        <td class="ganhoValor">‚Äî</td>
        <td class="ganhoPerc">‚Äî</td>
      </tr>
    </tbody>
  </table>

  <h2>2Ô∏è‚É£ Futuras Oportunidades</h2>
  <table id="futureTable">
    <thead>
      <tr>
        <th>Ativo</th>
        <th>Valor Planeado (‚Ç¨)</th>
        <th>Pre√ßo Atual (‚Ç¨)</th>
        <th>Unidades Est.</th>
      </tr>
    </thead>
    <tbody>
      <tr><td>NVDA</td><td contenteditable="true">100</td><td><input type="number" step="0.01" placeholder="Pre√ßo"></td><td class="units">‚Äî</td></tr>
      <tr><td>LLY</td><td contenteditable="true">100</td><td><input type="number" step="0.01" placeholder="Pre√ßo"></td><td class="units">‚Äî</td></tr>
      <tr><td>AVGO</td><td contenteditable="true">100</td><td><input type="number" step="0.01" placeholder="Pre√ßo"></td><td class="units">‚Äî</td></tr>
      <tr><td>GOOGL</td><td contenteditable="true">100</td><td><input type="number" step="0.01" placeholder="Pre√ßo"></td><td class="units">‚Äî</td></tr>
      <tr><td>TSLA</td><td contenteditable="true">100</td><td><input type="number" step="0.01" placeholder="Pre√ßo"></td><td class="units">‚Äî</td></tr>
      <tr><td>INFY</td><td contenteditable="true">100</td><td><input type="number" step="0.01" placeholder="Pre√ßo"></td><td class="units">‚Äî</td></tr>
    </tbody>
  </table>

  <canvas id="portfolioChart" width="400" height="200"></canvas>

  <script>
    const ctx = document.getElementById('portfolioChart').getContext('2d');
    let chart;

    function updateCurrent() {
      const rows = document.querySelectorAll("#currentTable tbody tr");
      const data = [];
      let total = 0;

      rows.forEach(r => {
        const invested = parseFloat(r.children[2].innerText);
        const units = parseFloat(r.children[1].innerText);
        const price = parseFloat(r.querySelector("input").value);

        if (!isNaN(price)) {
          const atual = units * price;
          const ganho = atual - invested;
          const perc = (ganho / invested) * 100;

          r.querySelector(".valorAtual").innerText = atual.toFixed(2);
          r.querySelector(".ganhoValor").innerText = ganho.toFixed(2);
          r.querySelector(".ganhoValor").className = ganho >= 0 ? "gain" : "loss";
          r.querySelector(".ganhoPerc").innerText = perc.toFixed(2) + "%";
          r.querySelector(".ganhoPerc").className = perc >= 0 ? "gain" : "loss";

          total += atual;
          data.push({ name: r.children[0].innerText, value: atual });
        }
      });

      updateChart(data);
    }

    function updateFuture() {
      const rows = document.querySelectorAll("#futureTable tbody tr");
      const data = [];

      rows.forEach(r => {
        const value = parseFloat(r.children[1].innerText);
        const price = parseFloat(r.querySelector("input").value);
        if (!isNaN(price) && !isNaN(value)) {
          const units = value / price;
          r.querySelector(".units").innerText = units.toFixed(3);
          data.push({ name: r.children[0].innerText, value });
        }
      });

      return data;
    }

    function updateChart(extra = []) {
      const currentRows = document.querySelectorAll("#currentTable tbody tr");
      const chartData = [];

      currentRows.forEach(r => {
        const price = parseFloat(r.querySelector("input").value);
        const units = parseFloat(r.children[1].innerText);
        if (!isNaN(price)) {
          chartData.push({ label: r.children[0].innerText, value: units * price });
        }
      });

      const futureData = updateFuture();
      const allData = [...chartData, ...futureData];
      const labels = allData.map(d => d.label);
      const values = allData.map(d => d.value);

      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: 'pie',
        data: {
          labels,
          datasets: [{
            data: values,
          }]
        },
        options: {
          plugins: {
            legend: { labels: { color: '#e0e0e0' } }
          }
        }
      });
    }

    document.querySelectorAll("input").forEach(inp => inp.addEventListener("input", () => {
      updateCurrent();
      updateChart();
    }));
  </script>

</body>
</html>