<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Monitoramento de Portf√≥lio - Longo Prazo</title>
  <style>
    body { font-family: Arial, sans-serif; background: #0a0a0a; color: #e0e0e0; margin: 20px; }
    h1 { color: #00ffcc; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #444; padding: 10px; text-align: center; }
    th { background-color: #1e1e1e; }
    input { width: 100px; text-align: right; }
    button { background: #00ffcc; color: #000; border: none; padding: 10px 20px; cursor: pointer; border-radius: 5px; margin-top: 20px; }
    button:hover { background: #00e0b3; }
    .footer { margin-top: 20px; font-size: 12px; color: #888; }
  </style>
</head>
<body>
  <h1>üìä Monitoramento de Portf√≥lio - 10 Ativos</h1>
  <p>Digite o valor total (‚Ç¨) ou a % desejada para cada ativo. Clique em <b>Atualizar</b> para buscar os pre√ßos em tempo real (TwelveData).</p>

  <table id="portfolioTable">
    <thead>
      <tr>
        <th>Ativo</th>
        <th>%</th>
        <th>Valor (‚Ç¨)</th>
        <th>Pre√ßo Atual (‚Ç¨)</th>
        <th>Unidades</th>
        <th>Segmento</th>
      </tr>
    </thead>
    <tbody>
      <!-- dados inseridos via JS -->
    </tbody>
  </table>

  <button onclick="updatePortfolio()">Atualizar com pre√ßos reais</button>

  <div class="footer">‚öôÔ∏è Fonte: TwelveData API (sem bloqueio CORS) ‚Äî Dados atualizados automaticamente.</div>

  <script>
    const apiKey = "0debbec4427d429c993d43982dbf9848"; // üîë Coloque sua API key gratuita aqui

    const portfolio = [
      { symbol: "VUAA.L", percent: 18, value: 90, segment: "ETF S&P500" },
      { symbol: "MSFT", percent: 6, value: 30, segment: "Tech / Cloud" },
      { symbol: "NVDA", percent: 4, value: 20, segment: "AI / Chips" },
      { symbol: "LLY", percent: 5, value: 25, segment: "Farma / Biotech" },
      { symbol: "AVGO", percent: 5, value: 25, segment: "Infraestrutura AI" },
      { symbol: "GOOGL", percent: 5, value: 25, segment: "Cloud / Ads / IA" },
      { symbol: "TSLA", percent: 4, value: 20, segment: "Energia / Mobilidade" },
      { symbol: "INFY", percent: 3, value: 15, segment: "Servi√ßos TI" },
      { symbol: "IGLD.L", percent: 30, value: 150, segment: "Ouro f√≠sico ETC" },
      { symbol: "BTC/USD", percent: 15, value: 75, segment: "Cripto" }
    ];

    const tableBody = document.querySelector("#portfolioTable tbody");

    // monta a tabela inicial
    function loadTable() {
      tableBody.innerHTML = "";
      portfolio.forEach(p => {
        const row = `
          <tr>
            <td>${p.symbol}</td>
            <td>${p.percent}%</td>
            <td contenteditable="true">${p.value.toFixed(2)}</td>
            <td class="price">‚Äî</td>
            <td class="units">‚Äî</td>
            <td>${p.segment}</td>
          </tr>`;
        tableBody.insertAdjacentHTML("beforeend", row);
      });
    }

    async function updatePortfolio() {
      const rows = document.querySelectorAll("#portfolioTable tbody tr");
      for (let i = 0; i < portfolio.length; i++) {
        const p = portfolio[i];
        const value = parseFloat(rows[i].children[2].innerText);
        const url = `https://api.twelvedata.com/price?symbol=${p.symbol}&apikey=${apiKey}`;
        try {
          const res = await fetch(url);
          const data = await res.json();
          const price = parseFloat(data.price);
          const units = (value / price).toFixed(3);
          rows[i].children[3].innerText = price.toFixed(2);
          rows[i].children[4].innerText = units;
        } catch (err) {
          rows[i].children[3].innerText = "Erro";
          rows[i].children[4].innerText = "‚Äî";
        }
      }
    }

    loadTable();
  </script>
</body>
</html>
